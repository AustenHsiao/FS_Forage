<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="authors" content="Austen Hsiao, Sandy Wood, Travis McGowan">
<!--        <meta name="viewport" content="width=device-width, initial-scale=1.0" />   -->
        <title>Foraging App</title>


        <link
        rel="stylesheet"
        type="text/css"
        href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.1/css/bootstrap.min.css"
      />

      <link rel="stylesheet" href="/add_spot_full.css" />
        <script src="https://unpkg.com/react@16/umd/react.production.min.js"></script> 
        <script src="https://unpkg.com/react-dom@16/umd/react-dom.production.min.js"></script>  
        <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script> 
        <script async="false" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAW1polXZ_aJhq0AMs9o27vqrNtva1pCLQ&callback=initMap"></script>
    
    </head>
    <body>

        <div class="grid-container">
          <div  name="tborder" id = "tborder"></div>
          <div  name="lborder" id = "lborder"></div>
          <div  name="rborder" id = "rborder"></div>
          <div  name="bborder" id = "bborder"></div>
          <div class="navbar" name="navbar" id="navbar"></div>
          <a class="nav1 hlink" href="/pages/index.html" name="nav1" id="nav1">Main</a>
          <a class = "nav2 hlink" href="/pages/add_spot.html" name="nav2" id ="nav2">Add Spot</a>
          <a class = "nav3 hlink" href="#" name="nav3" id="nav3">About (todo)</a>
          <div class="title" name="title" id="title">NEW SPOT ENTRY FORM</div>
          <div class="detail" name="detail" id="detail"></div>
          <label for="nameinput" name="namelabel" id="namelabel">Spot Name:</label>
          <input type="text" name = "nameinput" id="nameinput" required/>
          <label for="speciesinput" name="specieslabel" id="specieslabel">Species Found:</label>
          <input type="text" name="speciesinput" id="speciesinput" required/>
          <label for="spotdetails" name="detailslabel" id = "detailslabel">Spot Details:(ingress/parking/conditions)</label>
          <input type="text" name ="detailsinput" id="detailsinput" />
          <button name ="submit" id="submit">Create New Spot</button> 
          <div class="container map" name="mapdiv" id="mapdiv"></div>
          <div name="mapdiscl" id="mapdiscl">Select new spot location:</div>
          <div id="mapBox" crossorigin="anonymous">map</div>
        </div>

        <script type="text/babel" >
            let locations = [];
            const initMap = () => {
                let coord = document.getElementById("coordinatesBox");
                coord.innerHTML = "";
                
                 const map = new google.maps.Map(document.getElementById("mapBox"), {
                    zoom: 13,
                    center: { lat: 45.5111, lng: -122.6834 }, //portland state university
                });

                google.maps.event.addListener(map, 'click', function(spot) {
                    const forageSpot = new google.maps.Marker({
                        position: spot.latLng, 
                        map: map,
                        draggable: true,
                        title: "new foraging spot"
                    });
                    let latlng = `${forageSpot.position.lat()}, ${forageSpot.position.lng()}`;
                    coord.innerHTML += `${locations.length+1}: ${latlng} <br>`
                    locations.push(latlng);
                });
            };

            //HARDCODED 11/15+++++++++++++++WIP++++++++++++++++++
            const cityName = 'Portland';
            const stateCode = 'Oregon';

            const getMap = async () => { 
                const api = await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${cityName},${stateCode}&appid=6e093cb352d4d124394962457cd432bc`);
                if(api.status === 404){
                    console.log("Data not found");
                    return null;
                }

                const data = await api.json();
                console.log(data)
                return data;
            }

            document.getElementById("submit").addEventListener("click", () =>{
                console.log("Submit button clicked");
            });
        </script>
    </body>
    
</html>