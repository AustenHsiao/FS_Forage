<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="authors" content="Austen Hsiao, Sandy Wood, Travis McGowan">
<!--        <meta name="viewport" content="width=device-width, initial-scale=1.0" />   -->
        <title>Foraging App</title>
        
        <link
        rel="stylesheet"
        type="text/css"
        href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.1/css/bootstrap.min.css"
      />

        <link rel="stylesheet" type="text/css" href="../css/add_spot_mobile.css" />
        <script src="https://unpkg.com/react@16/umd/react.production.min.js"></script>
        <script src="https://unpkg.com/react-dom@16/umd/react-dom.production.min.js"></script>
        <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>
        <script async="false" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAW1polXZ_aJhq0AMs9o27vqrNtva1pCLQ&callback=initMap"></script>
    
    </head>
    <body>

        <div class="grid-container">
          <div  name="tborder" id = "tborder"></div>
          <div  name="lborder" id = "lborder"></div>
          <div  name="rborder" id = "rborder"></div>
          <div  name="bborder" id = "bborder"></div>
          <div class="title" name="title" id="title">NEW SPOT ENTRY FORM</div>
          <div class="detail" name="detail" id="detail"></div>
          <label for="nameinput" name="namelabel" id="namelabel">Spot Name:</label>
          <input type="text" name = "nameinput" id="nameinput" required/>
          <label for="speciesinput" name="specieslabel" id="specieslabel">Species Found:</label>
          <input type="text" name="speciesinput" id="speciesinput" required/>
          <label for="spotdetails" name="detailslabel" id = "detailslabel">Spot Details:(ingress/parking/conditions)</label>
          <input type="text" name ="detailsinput" id="detailsinput" />
          <button name ="next" id="next">Next</button> 
          <button name ="cancel" id="cancel">Cancel Submission</button>
          <label style="visibility: hidden;" for="zipinput" name="ziplabel" id = "ziplabel">Drop pin at Zip:</label>
          <input style="visibility: hidden;" type="text" name ="zipinput" id="zipinput" /> 
          <div style="visibility: hidden;" class="container map" name="mapdiv" id="mapdiv"></div>
          <div style="visibility: hidden;" name="mapdiscl" id="mapdiscl">Select new spot location:</div>
          <div style="visibility: hidden;" name = "mapBox" id="mapBox" crossorigin="anonymous">map</div>
          <button style="visibility: hidden;" name ="submit" id="submit">Submit</button> 
        </div>

        <script type="text/babel" >
            let locations = [];
            const initMap = () => {
                let coord = document.getElementById("coordinatesBox");
                coord.innerHTML = "";
                
                 const map = new google.maps.Map(document.getElementById("mapBox"), {
                    zoom: 13,
                    center: { lat: 45.5111, lng: -122.6834 }, //portland state university
                });

                google.maps.event.addListener(map, 'click', function(spot) {
                    const forageSpot = new google.maps.Marker({
                        position: spot.latLng, 
                        map: map,
                        draggable: true,
                        title: "new foraging spot"
                    });
                    let latlng = `${forageSpot.position.lat()}, ${forageSpot.position.lng()}`;
                    coord.innerHTML += `${locations.length+1}: ${latlng} <br>`
                    locations.push(latlng);
                });
            };

            //HARDCODED 11/15+++++++++++++++WIP++++++++++++++++++
            const cityName = 'Portland';
            const stateCode = 'Oregon';

            const getMap = async () => { 
                const api = await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${cityName},${stateCode}&appid=6e093cb352d4d124394962457cd432bc`);
                if(api.status === 404){
                    console.log("Data not found");
                    return null;
                }

                const data = await api.json();
                console.log(data)
                return data;
            }

            document.getElementById("next").addEventListener("click", () =>{

                console.log("Next button clicked");

                /*ADD CODE HERE TO VALIDATE THE INFO ENTERED BY THE USER*/
                document.getElementById("ziplabel").style.visibility="visible";
                document.getElementById("zipinput").style.visibility="visible";
                document.getElementById("mapdiv").style.visibility="visible";
                document.getElementById("mapdiscl").style.visibility="visible";
                document.getElementById("mapBox").style.visibility="visible";
                document.getElementById("submit").style.visibility="visible";

                document.getElementById("detail").style.display="none";
                document.getElementById("namelabel").style.display="none";
                document.getElementById("nameinput").style.display="none";
                document.getElementById("specieslabel").style.display="none";
                document.getElementById("speciesinput").style.visibility="hidden";
                document.getElementById("detailslabel").style.visibility="hidden";
                document.getElementById("detailsinput").style.visibility="hidden";
                document.getElementById("next").style.visibility="hidden";


            });
        </script>

    </body>
    
</html>