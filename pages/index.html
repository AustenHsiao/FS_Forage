<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="authors" content="Austen Hsiao, Sandy Wood, Travis McGowan">
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Foraging App</title>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" crossorigin="anonymous">
        <link rel="stylesheet" href="../css/forage.css" />
        <script src="https://unpkg.com/react@16/umd/react.production.min.js"></script>
        <script src="https://unpkg.com/react-dom@16/umd/react-dom.production.min.js"></script>
        <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>
        <script async="false" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAW1polXZ_aJhq0AMs9o27vqrNtva1pCLQ&callback=initMap"></script>
    
    </head>
    <body>
        <nav class="navbar navbar-expand-lg bg-dark">
                <h3 class="navbar-brand title">ForageApp</h3>
                <a href="#">Page 1</a>
                <a href="#">Page 2</a>
                <a href="#">Page 3</a>
        </nav> 
        <div class="container whole">
            <div class="container coord"> 
                <div id="coordinatesBox">coordinates</div>
            </div>

            <div class="container map"> 
                <div id="mapBox" crossorigin="anonymous">map</div>
            </div>
        </div>

        <div class="container weather"> 
            <div id="weatherBox">weather</div>
        </div>

        <button id="testButton">HERE I AM</button>
        <script type="text/babel" >
            const initMap = () => {


                
                 const map = new google.maps.Map(document.getElementById("mapBox"), {
                    zoom: 13,
                    center: { lat: 45.5111, lng: -122.6834 }, //portland state university
                });

                google.maps.event.addListener(map, 'click', function(event) {
                    new google.maps.Marker({
                        position: event.latLng, 
                        map: map,
                        draggable: true,
                        title: "new foraging spot"
                    });
                });
            };

            
            
            
            

            const cityName = 'Portland';
            const stateCode = 'Oregon';

            const getWeather = async () => { 
                const api = await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${cityName},${stateCode}&appid=6e093cb352d4d124394962457cd432bc`);
                if(api.status === 404){
                    console.log("Data not found");
                    return null;
                }

                const data = await api.json();
                console.log(data)
                return data;
            }

            const getMap = async () => { 
                const api = await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${cityName},${stateCode}&appid=6e093cb352d4d124394962457cd432bc`);
                if(api.status === 404){
                    console.log("Data not found");
                    return null;
                }

                const data = await api.json();
                console.log(data)
                return data;
            }

            document.getElementById("testButton").addEventListener("click", () =>{
                const weather = getWeather();
                if(!weather){
                    ReactDOM.render(
                        React.createElement('h1', null, "No data found for location"),
                        document.getElementById('weatherBox')
                    );
                }else{
                    ReactDOM.render(
                        React.createElement('h1', null, `Weather for ${cityName},${stateCode}`),
                        document.getElementById('weatherBox')
                    );
                }
            });
        </script>
    </body>
    
</html>